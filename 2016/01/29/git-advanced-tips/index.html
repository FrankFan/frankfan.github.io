<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> git常用命令总结 · Frank Fan's Blog</title><meta name="description" content="git常用命令总结 - Frank Fan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://fy98.com/atom.xml" title="Frank Fan's Blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">首页</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">关于</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">git常用命令总结</h1><div class="post-info">2016年1月29日</div><div class="post-content"><p>本文总结了平时开发中常常用到的git命令。</p>
<a id="more"></a>
<h2 id="多出来的commit"><a href="#多出来的commit" class="headerlink" title="多出来的commit"></a>多出来的commit</h2><p>Git从将远程分支与本地分支合并可以有两种方式，一种是 <code>git pull</code>, 另一种是 <code>git fetch + git rebase</code>.<br>区分在于 <code>git pull</code> 是把远程分支代码拉下来，与本地分支进行merge操作，相当于<code>git fetch + git merge</code>；<br>所以使用<code>git pull</code>命令之后，会自动多出来一次merge的commit，从<code>git log</code>上面看到的情况就是多了一次commit, 而且git树也不那么整洁了。<br>推荐的做法是使用rebase而不是pull, 可以<code>git fetch ; git rebase</code> ，也可以<code>git pull —rebase</code>.</p>
<h2 id="tag-管理"><a href="#tag-管理" class="headerlink" title="tag 管理"></a>tag 管理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看tag</span></span><br><span class="line">$ git tag | grep dev_20150525</span><br><span class="line"><span class="comment"># 创建tag</span></span><br><span class="line">$ git tag dev_20150525_16 -m <span class="string">'comment'</span></span><br><span class="line"><span class="comment"># 把tag push到远程</span></span><br><span class="line">$ git push origin dev_20150525_16</span><br><span class="line">$ git push origin --tags</span><br><span class="line"></span><br><span class="line">Counting objects: 1, <span class="keyword">done</span>.</span><br><span class="line">Writing objects: 100% (1/1), 156 bytes | 0 bytes/s, <span class="keyword">done</span>.</span><br><span class="line">Total 1 (delta 0), reused 0 (delta 0)</span><br><span class="line">To git@github.com:FrankFan/fxxxk.git</span><br><span class="line"> * [new tag]         test_tag1 -&gt; test_tag1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除tag 本地删除</span></span><br><span class="line">$ git tag -d test_tag1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除远程的tag:推一个空的上去</span></span><br><span class="line"><span class="comment">#有的gitlab没有删除远程tag的权限</span></span><br><span class="line">$ git push origin :refs/tags/reg_201050709_01</span><br></pre></td></tr></table></figure>
<h2 id="git-stash-暂存"><a href="#git-stash-暂存" class="headerlink" title="git stash 暂存"></a>git stash 暂存</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 缓存到暂存区</span></span><br><span class="line">$ git stash</span><br><span class="line"><span class="comment"># 取出来</span></span><br><span class="line">$ git stash pop</span><br><span class="line"><span class="comment"># 查看暂存列表</span></span><br><span class="line">$ git stash list</span><br><span class="line"><span class="comment"># 清空</span></span><br><span class="line">$ git stash clear</span><br></pre></td></tr></table></figure>
<p>注意： <code>stash</code> 尽量少用，最好只缓存一次，不然顺序会搞不好弄乱的。</p>
<h2 id="添加一个忽略文件到-gitignore"><a href="#添加一个忽略文件到-gitignore" class="headerlink" title="添加一个忽略文件到 gitignore"></a>添加一个忽略文件到 gitignore</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git rm --cached your_ignored_file</span><br></pre></td></tr></table></figure>
<h2 id="一个好看的git-log"><a href="#一个好看的git-log" class="headerlink" title="一个好看的git log"></a>一个好看的git log</h2><p>默认 <code>git log</code> 样式不太好看，用 alias 换成一个比较好看的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global alias.lg <span class="string">"log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blu</span></span><br><span class="line"><span class="string">e)&lt;%an&gt;%Creset' --abbrev-commit"</span></span><br></pre></td></tr></table></figure>
<p><code>git</code>最强大的功能之一就是分支管理，下面总结下常用的<code>branch</code>命令。</p>
<h2 id="查看分支"><a href="#查看分支" class="headerlink" title="查看分支"></a>查看分支</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -a <span class="comment"># 列出所有分支,包括本地的和remote的</span></span><br><span class="line">* develop</span><br><span class="line">  master</span><br><span class="line"></span><br><span class="line">$ git branch <span class="comment"># 只列出本地分支</span></span><br><span class="line">* develop</span><br><span class="line">  master</span><br><span class="line">  remotes/origin/HEAD -&gt; origin/master</span><br><span class="line">  remotes/origin/develop</span><br><span class="line">  remotes/origin/master</span><br></pre></td></tr></table></figure>
<h2 id="创建分支-git-checkout-b-branchname"><a href="#创建分支-git-checkout-b-branchname" class="headerlink" title="创建分支 git checkout -b [branchname]"></a>创建分支 git checkout -b [branchname]</h2><p>我们经常需要基于<code>master</code>拉一个分支进行开发，开发完成之后再将代码合并会<code>master</code>分支.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ git branch testing <span class="comment"># 创建一个叫 `testing` 的分支</span></span><br><span class="line"></span><br><span class="line">$ git branch <span class="comment"># 列出本地分支，发现我们还在develop分支上</span></span><br><span class="line">* develop</span><br><span class="line">  master</span><br><span class="line">  testing</span><br><span class="line"></span><br><span class="line">$ git checkout testing <span class="comment"># 切换到testing分支上</span></span><br><span class="line">Switched to branch <span class="string">'testing'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上面2个命令，首先创建了一个分支，然后再切换到新的分支上。</span></span><br><span class="line"></span><br><span class="line">$ git checkout -b <span class="string">'testing2'</span> <span class="comment"># 这个命令结合了上面2条命令，创建分支后自动切换到新分支上</span></span><br><span class="line">Switched to a new branch <span class="string">'testing2'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将本地分支push到远程</span></span><br><span class="line">$ git push origin testing</span><br></pre></td></tr></table></figure>
<h2 id="删除分支-git-branch-d-branchname"><a href="#删除分支-git-branch-d-branchname" class="headerlink" title="删除分支 git branch -d [branchname]"></a>删除分支 git branch -d [branchname]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ git branch -d testing2</span><br><span class="line">Deleted branch testing2 (was 3ce3fc3). <span class="comment"># 删除成功</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果恰巧你当前也在要被删除的分支上，git就会报错：</span></span><br><span class="line"><span class="comment"># error: Cannot delete the branch 'testing2' which you are currently on.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除远程分支</span></span><br><span class="line">$ git push origin :[branchname]</span><br><span class="line">git push origin :testing</span><br><span class="line">To git@github.com:<span class="built_in">test</span>/testing.git</span><br><span class="line">- [deleted] testing</span><br><span class="line"><span class="comment"># 冒号前面的空格不能少，原理是把一个空分支push到server上，相当于删除该分支</span></span><br></pre></td></tr></table></figure>
<h2 id="切换分支-git-checkout-branchname"><a href="#切换分支-git-checkout-branchname" class="headerlink" title="切换分支 git checkout [branchname]"></a>切换分支 git checkout [branchname]</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout testing <span class="comment"># 切换到testing分支上</span></span><br><span class="line">Switched to branch <span class="string">'testing'</span></span><br></pre></td></tr></table></figure>
<h2 id="合并分支（解决冲突）"><a href="#合并分支（解决冲突）" class="headerlink" title="合并分支（解决冲突）"></a>合并分支（解决冲突）</h2><p>开发分支是用来开发新功能的，开发完毕后还是要将代码饭和到主分支 <code>master</code> 中。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout master <span class="comment"># 首先切换到 master 分支</span></span><br><span class="line">Switched to branch <span class="string">'master'</span></span><br><span class="line">Your branch is up-to-date with <span class="string">'origin/master'</span>.</span><br><span class="line"></span><br><span class="line">$ git merge testing</span><br><span class="line"><span class="comment"># git会自动合并，如果有冲突则解决冲突</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 冲突了， 解决冲突的办法是根据terminal的提示一个文件一个文件的修改。</span></span><br><span class="line">Auto-merging README.md</span><br><span class="line">CONFLICT (content): Merge conflict <span class="keyword">in</span> README.md</span><br><span class="line">Automatic merge failed; fix conflicts and <span class="keyword">then</span> commit the result.</span><br></pre></td></tr></table></figure>
<h2 id="git删除push到远程服务器的commit"><a href="#git删除push到远程服务器的commit" class="headerlink" title="git删除push到远程服务器的commit"></a>git删除push到远程服务器的commit</h2><p>如果不小心把不该提交的代码或者敏感的数据（如密码）提交到远程git服务器上，可以使用<code>git reset</code>回滚到上一个commit，并且<code>commit history</code>不留下任何痕迹。</p>
<p>具体做法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.通过找到想要退回到的commit_id</span></span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line"><span class="comment"># 2.本地回到上一个commit_id</span></span><br><span class="line">$ git reset --hard &lt;commit_id&gt;</span><br><span class="line"><span class="comment"># 3.推送到服务器，一定要加 --force 参数</span></span><br><span class="line">$ git push origin HEAD:master --force</span><br></pre></td></tr></table></figure>
<p>如果不加<code>--force</code>参数提交不上去，服务器rejected.<br><img src="http://images2015.cnblogs.com/blog/282019/201509/282019-20150908175619012-1314340411.jpg" alt=""></p>
<p>最后你会发现，代码服务器上也不会留下痕迹，完美。</p>
</div></article></div></main><footer><div class="paginator"><a href="/2016/03/18/ubuntu-in-vps/" class="prev">PREV</a><a href="/2016/01/08/cmd-line-in-Mac-OS/" class="next">NEXT</a></div><div class="copyright"><p>© 2014 - 2018 <a href="http://fy98.com">Frank Fan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>